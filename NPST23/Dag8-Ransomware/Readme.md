## Dag 8 - Ransomware

```
Emne: Sort p친 Hvitt

Skjermen p친 en av datamaskinene p친 NISSENS verksted ble plutselig dekket av mange meldinger om at viktige filer var blitt kryptert. Et team av alver klarte 친 finne igjen denne filen sammen med en h칮yst mistenkelig fil, men klarer ikke 친 dekryptere filen. De har delt filene i et ZIP-arkiv med infected som passord. Klarer du 친 f친 tilbake den viktige filen?

- Tastefinger

游늹mistenkelig_beslag.zip
```

Denne tok meg et par dager..\
Hadde tidlig funnet ut at f칮rste linjen var noe med n칮kkelen i RSA. Fant senere ut at dette var N.
`0xF92B7110BA05839D0EC18DE9BA8DE489048B2A0C2AAE3FF1FAC83AB7799E8B45747E0D698DDDB424BE09C34B3CCFAFE88D4CB46F73701696E39B04298AA115438C152C0666D08858B8F46C29039CE3AC978A4EB2EADE7D113DC3691F52D3707E9F7A11C19514071EDA4A3534BC530DC54BD7EB4A4DB94F0B0B9784828768B5305AFF932F836F340A140162AA0C7FF97660B4B314C4D03D95B0ECF82A192193CA137FF0F6C6094AE6E3DE4B60E475F56277373FF73973F1F71D61A567F250BA24755D29D8B5DCE41F6A91117EC09981F1598BB5387D111CCBD3D8F465A4842D052155C638C0DB8674389986F46BD5DE61643854B6724901986E2D2111464383FB87494E2626082089C8A5A80A0BB6F994A0DA2FCD366DFB3F1003E4A20D5549CD1F6DB4D70E5151D5B70A2AEE02139953247E6B6E242A1777BD8042BCF81C7BBB2236EA3DE36764A3CC5430FC2A8828C7A86504F0D9E9C939ACE73C7B853F4582EA39496BDC9B074410EE19FC4A4828C9720E49F311479E59AC6964971A923483DE36BFBEBAE8E3E02F60ED4944A1C58D9FDA1DD091CC47E681608D99012DD5FA086396BA98D8BF76ADB2762D0C6AA878A5E74AB8674DD4FC90DAF04BFF71BA2B2C4452A3C81A293286A085A97398EE65FB54C932C0464CAA400DCB52821E06451811C2C0BC0EAB2DC0A6F5E44F48C4DA701BC05D9B75311B8243EFB4DF9FBB35`\
Ciphertext oversatt til hex ble s친 til, som var samme lengde:
`0xE882A3043D36478FE9DCBD5D18A2CE2D631D5FC7C54212C0AECF205ECC6C73BDBDAB3E5AA054C69A9B8EE9478A7AD4DE0E6B364BD6EECB12F270FF2E8331C29E8E2DA55EEA261B1537D0DD669B08A13E971DAF3E8C22C697ED7495627867E06B45E8875B9A80290449327433D3AF4FE1332FF10686927CC334F47C3E65994186D2FEC7FA980D1A797BF07DFF4E0807A62DDD47D246FF8FB2C32221E5017BB5F512D0AB4CC67A9C785AD8A4ECC9B2C64453DF81826B623B07F505C6FFFE8034C8CAF7DF67778E287B993D0178646689432FCB1C82E19A55AEB832BC720A78EF690166A1A442074AD172A29AE83CFCA3F4EC528290D6EDA561343387A024DD77D1D9C25B7E88FDCB26301DD4AFED8D8B19D3570F3550B4039BEB73DADEFD9883EC4636E6BBAD764AEAB4E89DA2860238ADBBD043F497C1139CD656D25FB7745E8821525A62AE004427D45F5CEB2A5811A9D1D92241DA5B187BC7B6DC6C969828E21D086DF3BA28009E4467E3C65FCED7CDF141E40F5700498FED5073D3E69D2641F1E0547F8F26E647B9C877C8FF5D49CE1AB7066C67EF7068E09AA33B0EDCED9D466EE2F8D4EA45BCDC0DA3EF965487A5AE88552280D8AC682E85C7F36403B1D35D0699B14E5BACD2F6A5CA9A4D6DB74638697B003124E54BEAF4713A7B9659D3C182C8AA4B50C037EA1EE94D52FD6B4C0B13A4B1483C99407D926E92BA43343B`

Sjekket etter noen dager om N tilfeldigvis var et primtall, noe som er usannsynlig men gj칮r det ihvertfall mulig 친 l칮se oppgaven ved RSA's svakhet n친r N er prime.

Pr칮vde 친 bruke disse verdiene sammen med svakheten til RSA n친r N er primtall, og kom til slutt frem til flagget.

Flagg:\
`NSM{65d77649dcd02ab0fed102c3e3d3d33faba1874038c7bda737c40604021034b4}`

# Egg 1

Kalenderens f칮rste egg ble tilfeldig funnet tidlig i oppgaven. Main-funksjonen kaller en funksjon som enten spiller av morsekode som staver EGGBEEPBOOP, eller spiller musikken fra "coffin dance"

EGG:\
`EGG{BEEPBOOP}`

# Egg 2

Main-funksjonen kaller en funksjon kalt "StartAddress", denne kj칮res 64 ganger med en forskjellig verdi (0-64) satt inn som lpThreadParameter hver gang.\
Funksjonen bruker denne til sende ut meldinger som "Har du vurdert 친 gi opp?" "Step, step, step..." osv osv, men hvis lpThreadParameter er mindre enn 38 vil en egen kodesekvens ogs친 kj칮re, der den blant annet tar noe fra et dword-array.\
Fant ut at meldingsboksen som denne delen brukes til hadde meldingen "Hemmelighet"\
Testet diverse, implementerte alt det relevante i python (egg_2.py)\
(Holdt p친 i sikkert 4 timer fordi min implementasjon av int32 overflows var litt feil :P)\
Koden kan finnes [her](Egg_2.py).

EGG:\
`EGG{91d54eb496a1713f5ecdd4d8b1cd636f}`
