# RSA7777

Logg inn og les flagget!

```sh
ssh john@rsa7777
```

---

```
login@corax ~/1_grunnleggende/1.13_RSA7777 $ ssh john@rsa7777
Hi john!
Due to recent security issues we are moving away from passwords and we will be using keys.

Public key:
ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAADzQGt3NF3nyHJPSJoA3201S8SEO856QXU5Tx8otw0ge4IEhYJECYptgJbgZiTaui476XoqdDjWI22MUsURHOtjqgRF7oRxs5IJU501FZh7utyqjQ5gccNKGHKBmMA/J94iTUEuzQ44uK/zRB+elkzLEVv1Df1LsqOxPF2mKYQzGxeLzD5WfPI8UwcczYYjbtlyrpTcA5tzmeLnqcERzd/9EctuwSvL9Cv7JVn/9gLyPZur5oW68oaueWwLDxJj9gxYP6URxb9Jkyk5EPRO2QiXn9JiIfKgtU0g1qm+Eg8w9bD/ts8wjw5IqUmjLeH0X9OSh/FKn7ASaNytygfG3Zp5IWmOaIE9oeUQyaQWmgcesYKv32VlgMpUB/vpfhsI6+jwIE9XwUbF6uDaYX1xHi+kebnJmLWimadHQPgzBqOuBdOGi58cNPkxy5y+n1UNatEuh18OWaLGhITTcT2mRVPgLK6Ahk6UlTUodMGGMXgSioILredNkVvszVFnXApK3iQAVgug0kpfWKt33Pn5I55z0TmxqTfijF1sY7T1MhsT6TI4F8djR03akuLMs+lcHw+MFTuxUTV2gwhTThMSbrs8ftpCEZSzzxg/mPOhxsciM0bJZWP1bOamndhrIbALK4wuXCoantwChd+6GVKZ5DOrg+6XSgrI1BWgCmf+HQ/i6X6Snvg7wQ9r1atkcO5el8tEBvgH+TewuQtBTByJ4zPlxUySO29LjmGPQ+kCLCEyPfZ78ibBL3ZUNbl2Xum3WuDp58FR/oS1dZr/U+bUFfBj/QngYQCJZQf+R/AzXJzbzP/DwrhI5yW1BvtCNaGDds9GhweGZ0YyK9nl067EuJ/GD4GA35U/f4lh2NGOPi4Rz0rMX9RIXj0i7malmYLwwmSMXp8IVe+a8QdM93uu5Et6UO6HgfADSCf4Q0cKA12UGbIR5NH7ujIp63dsdwgUTQ5vBu+GpxqgQeKydsu5N3y+sXOO7O087nIrhMVuK3PVKuFJ+nNfHVsq1y1LFLl1Ral7+K1vgB9ZnzNVVrwJPZgC6+kt4g1llhtr/XgABYadv4Trw4QgAT+EQ+VYEJa3idJoUQy4tbbbDOmmKRzMxAsZVmroMDRYtJC7x8+i45LRIBNMhQ/Pz2gucLiHdpKNF9e1liIu1UkM20NOFtcWvDAX9laLkrsWgpypUBiLS7RtyXgTNjovWZo3U+CMy6VjabPdGf4JqUJDT+YZXYl2S7CfGm6SACzuyeabs2HudYoCBMcgqkefQIcRrVpLMLMpfZuD/XoKzqvVNrC6Egx4u0=
john@rsa7777: Permission denied (publickey).
```

7777 bit public key er alt for mye, og en rar størrelse, så antageligvis usikkert...

```sh
login@corax ~/1_grunnleggende/1.13_RSA7777 $ ssh-keygen -f ~/storage/john_public.txt -e -m PEM > ~/storage/johnkey.pem
login@corax ~/1_grunnleggende/1.13_RSA7777 $ openssl rsa -pubin -in ~/storage/johnkey.pem -text -noout
Public-Key: (7777 bit)
Modulus:
    01:ad:dc:d1:77:9f:21:c9:3d:22:68:03:7d:b4:d5:
    2f:12:10:ef:39:e9:05:d4:e5:3c:7c:a2:dc:34:81:
    ee:08:12:16:09:10:26:29:b6:02:5b:81:98:93:6a:
    e8:b8:ef:a5:e8:a9:d0:e3:58:8d:b6:31:4b:14:44:
    73:ad:8e:a8:11:17:ba:11:c6:ce:48:25:4e:74:d4:
    56:61:ee:eb:72:aa:34:39:81:c7:0d:28:61:ca:06:
    63:00:fc:9f:78:89:35:04:bb:34:38:e2:e2:bf:cd:
    10:7e:7a:59:33:2c:45:6f:d4:37:f5:2e:ca:8e:c4:
    f1:76:98:a6:10:cc:6c:5e:2f:30:f9:59:f3:c8:f1:
    4c:1c:73:36:18:8d:bb:65:ca:ba:53:70:0e:6d:ce:
    67:8b:9e:a7:04:47:37:7f:f4:47:2d:bb:04:af:2f:
    d0:af:ec:95:67:ff:d8:0b:c8:f6:6e:af:9a:16:eb:
    ca:1a:b9:e5:b0:2c:3c:49:8f:d8:31:60:fe:94:47:
    16:fd:26:4c:a4:e4:43:d1:3b:64:22:5e:7f:49:88:
    87:ca:82:d5:34:83:5a:a6:f8:48:3c:c3:d6:c3:fe:
    db:3c:c2:3c:39:22:a5:26:8c:b7:87:d1:7f:4e:4a:
    1f:c5:2a:7e:c0:49:a3:72:b7:28:1f:1b:76:69:e4:
    85:a6:39:a2:04:f6:87:94:43:26:90:5a:68:1c:7a:
    c6:0a:bf:7d:95:96:03:29:50:1f:ef:a5:f8:6c:23:
    af:a3:c0:81:3d:5f:05:1b:17:ab:83:69:85:f5:c4:
    78:be:91:e6:e7:26:62:d6:8a:66:9d:1d:03:e0:cc:
    1a:8e:b8:17:4e:1a:2e:7c:70:d3:e4:c7:2e:72:fa:
    7d:54:35:ab:44:ba:1d:7c:39:66:8b:1a:12:13:4d:
    c4:f6:99:15:4f:80:b2:ba:02:19:3a:52:54:d4:a1:
    d3:06:18:c5:e0:4a:2a:08:2e:b7:9d:36:45:6f:b3:
    35:45:9d:70:29:2b:78:90:01:58:2e:83:49:29:7d:
    62:ad:df:73:e7:e4:8e:79:cf:44:e6:c6:a4:df:8a:
    31:75:b1:8e:d3:d4:c8:6c:4f:a4:c8:e0:5f:1d:8d:
    1d:37:6a:4b:8b:32:cf:a5:70:7c:3e:30:54:ee:c5:
    44:d5:da:0c:21:4d:38:4c:49:ba:ec:f1:fb:69:08:
    46:52:cf:3c:60:fe:63:ce:87:1b:1c:88:cd:1b:25:
    95:8f:d5:b3:9a:9a:77:61:ac:86:c0:2c:ae:30:b9:
    70:a8:6a:7b:70:0a:17:7e:e8:65:4a:67:90:ce:ae:
    0f:ba:5d:28:2b:23:50:56:80:29:9f:f8:74:3f:8b:
    a5:fa:4a:7b:e0:ef:04:3d:af:56:ad:91:c3:b9:7a:
    5f:2d:10:1b:e0:1f:e4:de:c2:e4:2d:05:30:72:27:
    8c:cf:97:15:32:48:ed:bd:2e:39:86:3d:0f:a4:08:
    b0:84:c8:f7:d9:ef:c8:9b:04:bd:d9:50:d6:e5:d9:
    7b:a6:dd:6b:83:a7:9f:05:47:fa:12:d5:d6:6b:fd:
    4f:9b:50:57:c1:8f:f4:27:81:84:02:25:94:1f:f9:
    1f:c0:cd:72:73:6f:33:ff:0f:0a:e1:23:9c:96:d4:
    1b:ed:08:d6:86:0d:db:3d:1a:1c:1e:19:9d:18:c8:
    af:67:97:4e:bb:12:e2:7f:18:3e:06:03:7e:54:fd:
    fe:25:87:63:46:38:f8:b8:47:3d:2b:31:7f:51:21:
    78:f4:8b:b9:9a:96:66:0b:c3:09:92:31:7a:7c:21:
    57:be:6b:c4:1d:33:dd:ee:bb:91:2d:e9:43:ba:1e:
    07:c0:0d:20:9f:e1:0d:1c:28:0d:76:50:66:c8:47:
    93:47:ee:e8:c8:a7:ad:dd:b1:dc:20:51:34:39:bc:
    1b:be:1a:9c:6a:81:07:8a:c9:db:2e:e4:dd:f2:fa:
    c5:ce:3b:b3:b4:f3:b9:c8:ae:13:15:b8:ad:cf:54:
    ab:85:27:e9:cd:7c:75:6c:ab:5c:b5:2c:52:e5:d5:
    16:a5:ef:e2:b5:be:00:7d:66:7c:cd:55:5a:f0:24:
    f6:60:0b:af:a4:b7:88:35:96:58:6d:af:f5:e0:00:
    16:1a:76:fe:13:af:0e:10:80:04:fe:11:0f:95:60:
    42:5a:de:27:49:a1:44:32:e2:d6:db:6c:33:a6:98:
    a4:73:33:10:2c:65:59:ab:a0:c0:d1:62:d2:42:ef:
    1f:3e:8b:8e:4b:44:80:4d:32:14:3f:3f:3d:a0:b9:
    c2:e2:1d:da:4a:34:5f:5e:d6:58:88:bb:55:24:33:
    6d:0d:38:5b:5c:5a:f0:c0:5f:d9:5a:2e:4a:ec:5a:
    0a:72:a5:40:62:2d:2e:d1:b7:25:e0:4c:d8:e8:bd:
    66:68:dd:4f:82:33:2e:95:8d:a6:cf:74:67:f8:26:
    a5:09:0d:3f:98:65:76:25:d9:2e:c2:7c:69:ba:48:
    00:b3:bb:27:9a:6e:cd:87:b9:d6:28:08:13:1c:82:
    a9:1e:7d:02:1c:46:b5:69:2c:c2:cc:a5:f6:6e:0f:
    f5:e8:2b:3a:af:54:da:c2:e8:48:31:e2:ed
Exponent: 65537 (0x10001)
```

Antok at det kom til å være lettløselig med feks fermat faktorisering pga den rare størrelsen, og ja, faktorene var nesten helt like
```sh
py .\solve_rsa7777.py
p = 3289788475948427353188797713102812013550206411428174862386386866440399066317040125106001974422205614101057651952957447514190601497223606860562524313497424999821649973312816994122718009917101619248214284315551012441803226789626036329037427739238227034485724304718881398633966692389888587312634374483868737895248473966350212645938698476049701942226017506180197742498792308479487431080715441023522868633209952548711357972820097592974651737747395818196160924428952678858883047818181325355399066471571508578464187184743337244208974772003241352212972467550964998576034628916944107092556411104558016190922587097394923915118284484221238638102257667096455519037649999368916612621625281569633525628352247752333813031144709403139202764533128402027407395704664658340140570493038798700773535425391031470441469694428613013317555428835779962427617979122351244882500381205620098619554858993944528831417272756155700965289010570700995225915896110902320604433901030551413429874320406927835859389776663464917338415307624470049955929623044892104406211065228622709527054884530308270270421328423932757167441918445725091146463369881237128845014849903412320539019790795817627800825692546919864731
q = 3289788475948427353188797713102812013550206411428174862386386866440399066317040125106001974422205614101057651952957447514190601497223606860562524313497424999821649973312816994122718009917101619248214284315551012441803226789626036329037427739238227034485724304718881398633966692389888587312634374483868737895248473966350212645938698476049701942226017506180197742498792308479487431080715441023522868633209952548711357972820097592974651737747395818196160924428952678858883047818181325355399066471571508578464187184743337244208974772003241352212972467550964998576034628916944107092556411104558016190922587097394923915118284484221238638102257667096455519037649999368916612621625281569633525628352247752333813031144709403139202764533128402027407395704664658340140570493038798700773535425391031470441469694428613013317555428835779962427617979122351244882500381205620098619554858993944528831417272756155700965289010570700995225915896110902320604433901030551413429874320406927835859389776663464917338415307624470049955929623044892104406211065228622709527054884530308270270421328423932757167441918445725091146463369881237128845014849903412320539019790795817627800825692546919866903
d = 1403515527593415416237966696765188942764719948132884349740110523744324283076303970094843974148859564355588372160882665274985346074939544885889491609329594940828066955213193859665380133248995512169524035745999563667909845488372314059909676715273806999425178633269501465754574180296694087206725712229367408216821920861520554947371935196336425167691085553793940573283421810909180445224858662233217622231492402920446895460445056182356409815386891055318956894392818444788156060274888847378298008130530446851840509118882384693743605796332028606722837909635095880966696648473889211320065826830525799247474589831918460735825869631056583870475887264032856258942466817463197877643160597878721949203579752388312695974664247451882786735405448400353890380851085677917748340955584398497291458521463541241399289745714552644093483023005677112651902074275543381635661785015347768223555204728602328260960142353975826729005392394102744567969049244213071852936337426389440762098235208327005336391622866271900304893231168110754823189766620963700025394969448576749555278620747908718655076836172993747746274353122581865375888506043272843320957173727211846224132423530161212514318279028127914052922992417058503782825989105668234610030568912029750739221850695132113609256762389306863590062952392215799096547463551799889851080950080811164601235564250557523701547645539606564355341360204041084661999204708604007535780973007920564534536545623158123573068486711645977926126003362665678198665975108419490521179090578411596933392170667858277212439198251123199193417156706472058375468021850288109945402226766546022883748922050097234989115458170438596857286104902849488405123169502529806281497612881022729256775709153822291287919660589922140078495610836969806953793696416973892816682426217843196621179148224444922146251368546866135883752675012138246451021593805608717389583820238503592440480867800752357556526017004875540739608927179344083383051013888480854978581859514930263968336939086138857361962753725640783550758986831358900901165323478096692263541515838982845157613602393677010627133677370652627538831951402924499781817465473242307232483610223998590773273789840025094918359090811669697290063717327805382688196776344212983779226020232130776721284282822213923398967963615906009724570801341131700337726561602367461466978482890150111651079591549761425849792242560066587893
Saved as john_key
```

```sh
login@corax ~/1_grunnleggende/1.12_Ubalansert $ ssh john@rsa7777 -i ~/storage/john_key
[...]
john@rsa7777:~$ ls -la
total 20
drwxr-xr-x. 1 john john   22 Dec 16 21:21 .
drwxr-xr-x. 1 root root   18 Dec 16 21:21 ..
-rw-r--r--. 1 john john  220 Jun  6  2025 .bash_logout
-rw-r--r--. 1 john john 3526 Jun  6  2025 .bashrc
-rw-r--r--. 1 john john  807 Jun  6  2025 .profile
drwx------. 1 john john   29 Dec 16 21:21 .ssh
-rw-------. 1 john john   33 Jan  1 21:17 flag.txt
-rw-------. 1 john john 1226 Dec 12 20:42 mailthread.txt
john@rsa7777:~$ cat flag.txt
3b15758df4d8273c8bb81d99d7f72b6c
```


Flagget er 3b15758df4d8273c8bb81d99d7f72b6c.
