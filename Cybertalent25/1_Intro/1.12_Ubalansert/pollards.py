import random
import math
from Crypto.Util.number import long_to_bytes, inverse

n = 669249705745076227011465782859184822906941298320198638192746266836619008742148679753752409753190015432053849071216270546766472796662174159166351965995629209476561673728408260977941795260313735994523719703003051220610319996261729736586321641273341360524146853449006269767932038667109201484137983245826087768210719108061243433447484871414942763287471023991518364141377489414984770066549362243936573312268815301923374907413087094106829054973563897656410367312947646267421280250308183213040860912058561458737044079428857181702122309898764830936896294291274377978282166182062716145669874597913133217665571565901925484329158284447401972789729496275227577930024953965155534772097551927478871318333589837941328723130982024245699226200176895159168904494178991735278818275114555853981956696478640778526130503371915134778096967605460266840695475112851887507583779624758669693354754887616898276886977852861031466113316102249433547718299787283824555718903833666795285076403725112617821300053183051518986382562474874573701471553867010888507606616991554517520392055359011740393548993334382822405958244707467782760434452818258510055189197045581181353469533799927222617231283673656509583855352412110413654966962945865261643934056493825000274913089363331133

e = 65537

c = 607257222419971353582567427456934335741098288633957616569643755508911556270959068349125468442607468731650789590369261848648991200967391176863678193732307018113729189569092689978370399833350990648479007889415191297008901050870189092913578658029371352309744152869300624191473779734499746514499039529484177962389419648783925757272138089770160008929180165025866252068766821656613704499017552008457031122516121014334094975296593770230308860281715103909718417428855151888047895981310839094369618469429384835656115510885495989710592125077528186773427953512223817404089255844424109676969660896113599565443762002298664680013567037751170230981179001979667857477458619262042240085595340714459939744677051633074070150421071733996805089309086938405121810350951693409715366914228074854192519384136464255309738282909987455539395941070447300734225055606504983867441031359037583496300587747992559726633802809419080492764828376401085093573937593530058218542410589835023318451945048137260954204718794676489581244440209618475513990263688431316286217537933328203637957951695367654030753251502461720434029916565566273324088236395579495876434954991943465353258808354345982508881949349960078501063060044313488313197432204695716980929533439652056823939472901150353

def pollards_rho(n):
    if n % 2 == 0:
        return 2

    while True:
        x = random.randrange(2, n - 1)
        y = x
        c = random.randrange(1, n - 1)
        d = 1

        while d == 1:
            x = (x * x + c) % n
            y = (y * y + c) % n
            y = (y * y + c) % n
            d = math.gcd(abs(x - y), n)

            if d == n:
                break

        if 1 < d < n:
            return d


def main():
    print("Factoring n...")
    p = pollards_rho(n)
    q = n // p

    print("p =", p)
    print("q =", q)

    phi = (p - 1) * (q - 1)
    d = inverse(e, phi)

    m = pow(c, d, n)
    print("Plaintext:")
    print(long_to_bytes(m))

if __name__ == "__main__":
    main()
